C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE API_USER_COMM
OBJECT MODULE PLACED IN .\Api_User_Comm.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\C_Source\S4_ApiUser\Api_User_Comm.c LARGE WARNINGLEVEL(1) BROWSE INCDIR(
                    -..\C_Source\S0_System;..\C_Source\S1_HardDrv;..\C_Source\S2_MyLib;..\C_Source\S3_ApiPlat;..\C_Source\S4_ApiUser;..\C_Sou
                    -rce\S5_ApiProtocol;..\C_Source\S6_MyIncludes;..\C_Source\S1_HardDrv\V9811A_EMU;..\C_Source\S1_HardDrv\V9811A_MCU;..\C_So
                    -urce\S1_HardDrv\E2P_24CXXX) DEBUG OBJECTEXTEND PRINT(.\Api_User_Comm.lst) OBJECT(.\Api_User_Comm.obj)

line level    source

   1          /*
   2          *****************Copyright (c)*************************************
   3          **      Hangzhou Xili Watthour Meter Manufacture Co., Ltd. 
   4          **--------------file info--------------------------------------------
   5          **name                  : Api_User_Comm.c
   6          **Author                : maji
   7          **date                  : 2016-04-21 
   8          **description   : Í¨Ñ¶´¦ÀíÓ¦ÓÃ²ãÏà¹Øº¯Êý³ÌÐòCÎÄ¼þ
   9          **note                  : V9811A £¬MERTER FOR DL03C
  10          **--------------------Version History -------------------------------------
  11          ** NO. Date         Ver      By         Description 
  12          **==============================================================
  13          ** 1   2016-04-26   v01.00   sosomj     1. frist version                             
  14          **
  15          **==============================================================
  16          */
  17          
  18          
  19          
  20          #include <MyIncludes_H.h>
  21          
  22          
  23          /*******************************************************************************
  24          * È«¾Ö±äÁ¿¶¨ÒåÇø
  25          *******************************************************************************/
  26          uint8 *P_IEC_BUFF;    //Í¨Ñ¶»º³åÇøÖ¸Õë //
  27          uint8 g_ch_comm;   //µ±Ç°Í¨Ñ¶Í¨µÀºÅ //
  28          UART_COMM_APP_VAR  gs_uart_iec_app_var[UART_CH_NUM];
  29          COMM_DATA  comm_data;
  30          
  31          
  32          /*******************************************************************************
  33          * ³£Á¿±íÇø
  34          *******************************************************************************/
  35          code INT8U Super_mima_iec[8] ={'4','5','6','1','2','3','0','0'};
  36          code INT8U meter_info[Meter_INFO_LENTH] = {'X','L','E','3','D','D','S','3','1','1','-','7','V','4','.','1'
             -,};        // ÒòÎªÔ¶ºìÍâ£¬À©Õ¹Îª2400bps//
  37          code INT8U meter_info_IR[Meter_INFO_LENTH] = {'X','L','E','2','D','D','S','3','1','1','-','7','V','4','.',
             -'1',};        // ÒòÎªÔ¶ºìÍâ£¬À©Õ¹Îª2400bps//
  38          code INT8U mima_info[MIMA_INFO_LENTH] = {'(','1','1','1','1','1','1','1','1',')',};
  39          
  40          /*********************************************************************************************************
  41          **  Í¨Ñ¶ID±í¸ñ
  42          ********************************************************************************************************/
  43           code IEC_COMDISTAB    IEC_ComDisTab[] =
  44          {
  45              // ÓÐ¹¦ºÏÏà·ÑÂÊ×Ü//
  46              0x00010000, &gs_energy_user_data.us_val[EC_CH_AC_PT_TT][TARIFF_T].buf[0],   EN_R+P_RAM,     4,8,    //µ±Ç°×ÜµçÁ
             -¿
  47              0x00010001, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L ,4,8,        //ÉÏ1ÔÂµçÁ¿
  48              0x00010002, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 2   

             -L,4,8,        //ÉÏ2ÔÂµçÁ¿
  49              0x00010003, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ3ÔÂµçÁ¿
  50              0x00010004, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ4ÔÂµçÁ¿
  51              0x00010005, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ5ÔÂµçÁ¿
  52              0x00010006, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ6ÔÂµçÁ¿
  53              0x00010007, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ7ÔÂµçÁ¿
  54              0x00010008, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ8ÔÂµçÁ¿
  55              0x00010009, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ9ÔÂµçÁ¿
  56              0x0001000A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT),        EN_R+P_E2P1+CM_BI
             -LL,4,8,        //ÉÏ10ÔÂµçÁ¿
  57              0x0001000B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT),        EN_R+P_E2P1+CM_BI
             -LL,4,8,        //ÉÏ11ÔÂµçÁ¿
  58              0x0001000C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_ec+TARIFF_T*LEN_EC_UNIT),        EN_R+P_E2P1+CM_BI
             -LL,4,8,        //ÉÏ12ÔÂµçÁ¿
  59              // ÓÐ¹¦·ÑÂÊ1 F1  //
  60              0x00010100, &gs_energy_user_data.us_val[EC_CH_AC_PT_TT][TARIFF1].buf[0],    EN_R+P_RAM,     4,8,    //µ±Ç°×ÜµçÁ¿
  61              0x00010101, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             - ,4,8,        //ÉÏ1ÔÂµçÁ¿
  62              0x00010102, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ2ÔÂµçÁ¿
  63              0x00010103, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ3ÔÂµçÁ¿
  64              0x00010104, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ4ÔÂµçÁ¿
  65              0x00010105, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ5ÔÂµçÁ¿
  66              0x00010106, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ6ÔÂµçÁ¿
  67              0x00010107, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ7ÔÂµçÁ¿
  68              0x00010108, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ8ÔÂµçÁ¿
  69              0x00010109, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ9ÔÂµçÁ¿
  70              0x0001010A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ10ÔÂµçÁ¿
  71              0x0001010B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ11ÔÂµçÁ¿
  72              0x0001010C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_ec+TARIFF1*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ12ÔÂµçÁ¿
  73              // ÓÐ¹¦·ÑÂÊ2 F2
  74              0x00010200, &gs_energy_user_data.us_val[EC_CH_AC_PT_TT][TARIFF2].buf[0],    EN_R+P_RAM,     4,8,    //µ±Ç°×ÜµçÁ¿
  75              0x00010201, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             - ,4,8,        //ÉÏ1ÔÂµçÁ¿
  76              0x00010202, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ2ÔÂµçÁ¿
  77              0x00010203, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ3ÔÂµçÁ¿
  78              0x00010204, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ4ÔÂµçÁ¿
  79              0x00010205, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ5ÔÂµçÁ¿
  80              0x00010206, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ6ÔÂµçÁ¿
  81              0x00010207, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 3   

             -,4,8,        //ÉÏ7ÔÂµçÁ¿
  82              0x00010208, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ8ÔÂµçÁ¿
  83              0x00010209, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ9ÔÂµçÁ¿
  84              0x0001020A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ10ÔÂµçÁ¿
  85              0x0001020B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ11ÔÂµçÁ¿
  86              0x0001020C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_ec+TARIFF2*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ12ÔÂµçÁ¿
  87              // ÓÐ¹¦·ÑÂÊ3 F3
  88              0x00010300,  &gs_energy_user_data.us_val[EC_CH_AC_PT_TT][TARIFF3].buf[0],   EN_R+P_RAM,     4,8,    //µ±Ç°×ÜµçÁ
             -¿
  89              0x00010301, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             - ,4,8,        //ÉÏ1ÔÂµçÁ¿
  90              0x00010302, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ2ÔÂµçÁ¿
  91              0x00010303, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ3ÔÂµçÁ¿
  92              0x00010304, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ4ÔÂµçÁ¿
  93              0x00010305, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ5ÔÂµçÁ¿
  94              0x00010306, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ6ÔÂµçÁ¿
  95              0x00010307, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ7ÔÂµçÁ¿
  96              0x00010308, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ8ÔÂµçÁ¿
  97              0x00010309, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ9ÔÂµçÁ¿
  98              0x0001030A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ10ÔÂµçÁ¿
  99              0x0001030B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ11ÔÂµçÁ¿
 100              0x0001030C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_ec+TARIFF3*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ12ÔÂµçÁ¿
 101              // ÓÐ¹¦·ÑÂÊ4 F4
 102              0x00010400, &gs_energy_user_data.us_val[EC_CH_AC_PT_TT][TARIFF4].buf[0],    EN_R+P_RAM,     4,8,    //µ±Ç°×ÜµçÁ¿
 103              0x00010401, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             - ,4,8,        //ÉÏ1ÔÂµçÁ¿
 104              0x00010402, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ2ÔÂµçÁ¿
 105              0x00010403, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ3ÔÂµçÁ¿
 106              0x00010404, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ4ÔÂµçÁ¿
 107              0x00010405, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ5ÔÂµçÁ¿
 108              0x00010406, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ6ÔÂµçÁ¿
 109              0x00010407, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ7ÔÂµçÁ¿
 110              0x00010408, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ8ÔÂµçÁ¿
 111              0x00010409, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT),  EN_R+P_E2P1+CM_BILL
             -,4,8,        //ÉÏ9ÔÂµçÁ¿
 112              0x0001040A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ10ÔÂµçÁ¿
 113              0x0001040B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ11ÔÂµçÁ¿
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 4   

 114              0x0001040C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_ec+TARIFF4*LEN_EC_UNIT), EN_R+P_E2P1+CM_BIL
             -L,4,8,        //ÉÏ12ÔÂµçÁ¿
 115          
 116              //ÐèÁ¿ ×Ü
 117              0x01010000, ADR_BLOCK01_MMD_L0_E2P+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1,8,16,//µ±Ç°ÐèÁ¿ÀàÊý¾Ý 3+5 ÐèÁ¿
             -+Ê±¼ä
 118              0x01010001, ADR_BLOCK101_BILL1_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 119              0x01010002, ADR_BLOCK102_BILL2_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 120              0x01010003, ADR_BLOCK103_BILL3_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 121              0x01010004, ADR_BLOCK104_BILL4_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 122              0x01010005, ADR_BLOCK105_BILL5_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 123              0x01010006, ADR_BLOCK106_BILL6_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 124              0x01010007, ADR_BLOCK107_BILL7_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 125              0x01010008, ADR_BLOCK108_BILL8_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 126              0x01010009, ADR_BLOCK109_BILL9_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 127              0x0101000A, ADR_BLOCK110_BILL10_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_
             -BILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 128              0x0101000B, ADR_BLOCK111_BILL11_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT), EN_R+P_E2P1+CM_
             -BILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 129              0x0101000C, ADR_BLOCK112_BILL12_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF_T*LEN_MMD_UNIT),EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 130                  //ÐèÁ¿ F1
 131                  0x01010100,     ADR_BLOCK01_MMD_L0_E2P+(TARIFF1*LEN_MMD_UNIT), EN_R+P_E2P1,8,16,//µ±Ç°ÐèÁ¿ÀàÊý¾Ý 3+5 ÐèÁ¿+Ê±¼
             -ä
 132              0x01010101, ADR_BLOCK101_BILL1_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 133              0x01010102, ADR_BLOCK102_BILL2_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 134              0x01010103, ADR_BLOCK103_BILL3_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 135              0x01010104, ADR_BLOCK104_BILL4_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 136              0x01010105, ADR_BLOCK105_BILL5_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 137              0x01010106, ADR_BLOCK106_BILL6_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 138              0x01010107, ADR_BLOCK107_BILL7_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 139              0x01010108, ADR_BLOCK108_BILL8_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 140              0x01010109, ADR_BLOCK109_BILL9_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 141              0x0101010A, ADR_BLOCK110_BILL10_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 142              0x0101010B, ADR_BLOCK111_BILL11_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 143              0x0101010C, ADR_BLOCK112_BILL12_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF1*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 144                  //ÐèÁ¿ F2
 145                  0x01010200,     ADR_BLOCK01_MMD_L0_E2P+(TARIFF2*LEN_MMD_UNIT), EN_R+P_E2P1,8,16,//µ±Ç°ÐèÁ¿ÀàÊý¾Ý 3+5 ÐèÁ¿+Ê±¼
             -ä
 146              0x01010201, ADR_BLOCK101_BILL1_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 5   

 147              0x01010202, ADR_BLOCK102_BILL2_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 148              0x01010203, ADR_BLOCK103_BILL3_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 149              0x01010204, ADR_BLOCK104_BILL4_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 150              0x01010205, ADR_BLOCK105_BILL5_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 151              0x01010206, ADR_BLOCK106_BILL6_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 152              0x01010207, ADR_BLOCK107_BILL7_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 153              0x01010208, ADR_BLOCK108_BILL8_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 154              0x01010209, ADR_BLOCK109_BILL9_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 155              0x0101020A, ADR_BLOCK110_BILL10_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 156              0x0101020B, ADR_BLOCK111_BILL11_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 157              0x0101020C, ADR_BLOCK112_BILL12_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF2*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 158                  //ÐèÁ¿ F3
 159                  0x01010300,     ADR_BLOCK01_MMD_L0_E2P+(TARIFF3*LEN_MMD_UNIT), EN_R+P_E2P1,8,16,//µ±Ç°ÐèÁ¿ÀàÊý¾Ý 3+5 ÐèÁ¿+Ê±¼
             -ä
 160              0x01010301, ADR_BLOCK101_BILL1_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 161              0x01010302, ADR_BLOCK102_BILL2_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 162              0x01010303, ADR_BLOCK103_BILL3_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 163              0x01010304, ADR_BLOCK104_BILL4_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 164              0x01010305, ADR_BLOCK105_BILL5_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 165              0x01010306, ADR_BLOCK106_BILL6_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 166              0x01010307, ADR_BLOCK107_BILL7_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 167              0x01010308, ADR_BLOCK108_BILL8_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 168              0x01010309, ADR_BLOCK109_BILL9_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 169              0x0101030A, ADR_BLOCK110_BILL10_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 170              0x0101030B, ADR_BLOCK111_BILL11_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 171              0x0101030C, ADR_BLOCK112_BILL12_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF3*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 172                  //ÐèÁ¿ F4  //
 173                  0x01010400,     ADR_BLOCK01_MMD_L0_E2P+(TARIFF4*LEN_MMD_UNIT), EN_R+P_E2P1,8,16,//µ±Ç°ÐèÁ¿ÀàÊý¾Ý 3+5 ÐèÁ¿+Ê±¼
             -ä
 174              0x01010401, ADR_BLOCK101_BILL1_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 175              0x01010402, ADR_BLOCK102_BILL2_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 176              0x01010403, ADR_BLOCK103_BILL3_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 177              0x01010404, ADR_BLOCK104_BILL4_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 178              0x01010405, ADR_BLOCK105_BILL5_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 6   

 179              0x01010406, ADR_BLOCK106_BILL6_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 180              0x01010407, ADR_BLOCK107_BILL7_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 181              0x01010408, ADR_BLOCK108_BILL8_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 182              0x01010409, ADR_BLOCK109_BILL9_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),        EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 183              0x0101040A, ADR_BLOCK110_BILL10_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 184              0x0101040B, ADR_BLOCK111_BILL11_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 185              0x0101040C, ADR_BLOCK112_BILL12_DATA_E2P+OFFSET_bill_data_mmd+(TARIFF4*LEN_MMD_UNIT),       EN_R+P_E2P1+CM_B
             -ILL,8,16,//ÉÏ1ÔÂÐèÁ¿Àà
 186          ///////////////////ÔÂ½áËãÊ±¼äµãÊý¾Ý///////////////////////////////////////////////////////////////////////
             -/////////
 187              0x03700101, ADR_BLOCK101_BILL1_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ1Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 188              0x03700102, ADR_BLOCK102_BILL2_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ2Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 189              0x03700103, ADR_BLOCK103_BILL3_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ3Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 190              0x03700104, ADR_BLOCK104_BILL4_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ4Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 191              0x03700105, ADR_BLOCK105_BILL5_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ5Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 192              0x03700106, ADR_BLOCK106_BILL6_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ6Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 193              0x03700107, ADR_BLOCK107_BILL7_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ7Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 194              0x03700108, ADR_BLOCK108_BILL8_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ8Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 195              0x03700109, ADR_BLOCK109_BILL9_DATA_E2P+(OFFSET_bill_data_dateTime),        EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ9Ô
             -Â½áËãÊ±¼äµã¼ÇÂ¼//
 196              0x0370010A, ADR_BLOCK110_BILL10_DATA_E2P+(OFFSET_bill_data_dateTime),       EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ1
             -0ÔÂ½áËãÊ±¼äµã¼ÇÂ¼//
 197              0x0370010B, ADR_BLOCK111_BILL11_DATA_E2P+(OFFSET_bill_data_dateTime),       EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ1
             -1ÔÂ½áËãÊ±¼äµã¼ÇÂ¼//
 198              0x0370010C, ADR_BLOCK112_BILL12_DATA_E2P+(OFFSET_bill_data_dateTime),       EN_R+P_E2P1+CM_BILL ,6,12,      //ÉÏ1
             -2ÔÂ½áËãÊ±¼äµã¼ÇÂ¼//
 199          //////////////////////////////////////////////////////////////////////////////////////////////////////////
             -///////////
 200              //±äÁ¿Êý¾Ý  //
 201              0x02010000,&gs_measure_var_data.gs_really[0].dw_u_val.B08[0],       EN_R+P_RAM,     2,4,    //ºÏÏàµçÑ¹ xxx.x                 YYY
 202              0x02010100,&gs_measure_var_data.gs_really[0].dw_u_val.B08[0],       EN_R+P_RAM,     2,4,    //AÏàµçÑ¹ xxx.x          YYY
 203              0x02020000,&gs_measure_var_data.gs_really[0].dw_i_val.B08[0],       EN_R+P_RAM,     3,6,    //ºÏÏàµçÁ÷   XXX.XXX
 204              0x02020100,&gs_measure_var_data.gs_really[0].dw_i_val.B08[0],       EN_R+P_RAM,     3,6,    //AÏàµçÁ÷   XXX.XXX
 205              0x02030000,&gs_measure_var_data.gs_really[0].dw_p_val.B08[0],     EN_R+P_RAM,       3,6,    // TOTAL ACTIVE POW
             -ER   XX.XXXX 
 206              0x02030100,&gs_measure_var_data.gs_really[0].dw_p_val.B08[0],     EN_R+P_RAM,       3,6,    // AÏà ACTIVE POWER
             -   XX.XXXX 
 207              0x02060000,&gs_measure_var_data.gs_really[0].dw_pf_val.B08[0],       EN_R+P_RAM,2,4,        //ºÏÏà¹¦ÂÊÒòÊý  X.XXX
 208              0x02060100,&gs_measure_var_data.gs_really[0].dw_pf_val.B08[0],       EN_R+P_RAM,2,4,        // AÏà¹¦ÂÊÒòÊý  X.XXX
 209              0x02800002,&gs_measure_var_data.gs_really[0].w_freq_val.B08[0],    EN_R+P_RAM,2,4,  //ÆµÂÊ  XX.XX
 210              0x02800003,&gs_md_var.min_var[0].val_min,    EN_R+P_RAM,3,6,        //µ±Ç°·ÖÖÓÐèÁ¿Êý¾Ý XX.XXXX 
 211              0x02800006,&gs_measure_var_data.w_temp.B08[0],    EN_R+P_RAM,2,4,   //ÎÂ¶È XX.XX
 212              0x02800007,&gs_measure_var_data.w_bat_v.B08[0],    EN_R+P_RAM,2,4,  //µç³ØµçÑ¹XX.XX
 213              0x02900001,&gs_current_triff_var.triff_No,    EN_R+P_RAM,1,2,       //µ±Ç°·ÑÂÊ 1~4//
 214              0x02900002,&gs_current_triff_var.dayTab_No,    EN_R+P_RAM,1,2,      //µ±Ç°·ÑÂÊ 1~4//
 215              0x02900003,&gs_current_triff_var.weekTab_No,    EN_R+P_RAM,1,2,     //µ±Ç°·ÑÂÊ 1~4//
 216              0x02900004,&gs_current_triff_var.seasonTab_No,    EN_R+P_RAM,1,2,   //µ±Ç°·ÑÂÊ 1~4//
 217          
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 7   

 218          
 219              // Ò»ÀàÊÂ¼þ  //
 220              //ÐèÁ¿¸´Î»   //
 221              0x03500000, ADR_BLOCK151_EVENI_resetMD_E2P,                 EN_R+P_E2P1,    2,4,    //×Ü´ÎÊý//
 222              0x03500101, ADR_BLOCK151_EVENI_resetMD_E2P+2,                      EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü1´Îµµ°¸¼ÇÂ¼·¢ÉúÊ
             -±¼ä//
 223              0x03500102, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 1*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü2´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 224              0x03500103, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 2*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü3´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 225              0x03500104, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 3*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü4´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 226              0x03500105, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 4*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü5´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 227              0x03500106, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 5*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü6´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 228              0x03500107, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 6*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü7´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 229              0x03500108, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 7*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü8´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 230              0x03500109, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 8*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü9´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼
             -ä//
 231              0x0350010A, (ADR_BLOCK151_EVENI_resetMD_E2P+2+ 9*4),        EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü10´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 232          
 233              //Í¨Ñ¶±à³Ì//
 234              0x03520000,  ADR_BLOCK150_EVENI_PROG_E2P,                   EN_R+P_E2P1,    2,4,    //×Ü´ÎÊý//
 235              0x03520101,  ADR_BLOCK150_EVENI_PROG_E2P+2,         EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü1´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä//
 236              0x03520102,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 1*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü2´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 237              0x03520103,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 2*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü3´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 238              0x03520104,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 3*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü4´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 239              0x03520105,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 4*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü5´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 240              0x03520106,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 5*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü6´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 241              0x03520107,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 6*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü7´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 242              0x03520108,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 7*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü8´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 243              0x03520109,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 8*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü9´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä/
             -/
 244              0x0352010A,  (ADR_BLOCK150_EVENI_PROG_E2P+2+ 9*4),  EN_R+P_E2P1+CM_EBIL, 4,8,//×î½ü10´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±¼ä
             -//
 245          
 246              //Ê±ÖÓÐ£×¼
 247              0x03570000,  ADR_BLOCK152_EVENI_setRtc_E2P,                 EN_R+P_E2P1,    2,4,    //×Ü´ÎÊý//
 248              0x03570101,  ADR_BLOCK152_EVENI_setRtc_E2P+2,                       EN_R+P_E2P1+CM_EBIL, 4,8,  //×î½ü1´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 249              0x03570102,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 1*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü2´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 250              0x03570103,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 2*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü3´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 251              0x03570104,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 3*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü4´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 252              0x03570105,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 4*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü5´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 253              0x03570106,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 5*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü6´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 254              0x03570107,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 6*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü7´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 8   

             -¼ä//
 255              0x03570108,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 7*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü8´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 256              0x03570109,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 8*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü9´Îµµ°¸¼ÇÂ¼·¢ÉúÊ±
             -¼ä//
 257              0x0357010A,  (ADR_BLOCK152_EVENI_setRtc_E2P+2+ 9*4),        EN_R+P_E2P1+CM_EBIL, 4,8, //×î½ü10´Îµµ°¸¼ÇÂ¼·¢ÉúÊ
             -±¼ä//
 258          
 259             //µç³ØÇ·Ñ¹ ÌØÊâ´¦Àí  Ö»³­¶Á·¢ÉúÊ±¼ä//        
 260                  0x03590000,   ADR_BLOCK162_EVENII_lowbattery_E2P,            EN_R+P_E2P1, 2,4,  //×Ü´ÎÊý
 261                  0x03590001,   ADR_BLOCK162_EVENII_lowbattery_E2P+2,          EN_R+P_E2P1, 4,8,  //ÀÛ¼ÆÊ±¼ä
 262                  0x03590101,   ADR_BLOCK162_EVENII_lowbattery_E2P+6,                  EN_R+P_E2P1+CM_EBIL, 12,24,         //×î½üÒ»´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 263                  0x03590102,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 1*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 264                  0x03590103,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 2*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 265                  0x03590104,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 3*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 266                  0x03590105,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 4*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 267                  0x03590106,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 5*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 268                  0x03590107,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 6*6),        EN_R+P_E2P1+CM_EBIL, 12,24,//×î½üÈý´Îµµ°¸¼ÇÂ¼ 
             - ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 269                  0x03590108,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 7*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 270                  0x03590109,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 8*6),        EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼
             -  ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 271                  0x0359010A,  (ADR_BLOCK162_EVENII_lowbattery_E2P+6+ 9*6),        EN_R+P_E2P1+CM_EBIL, 12,24,//×î½ü¶þ´Îµµ°¸¼ÇÂ¼ 
             - ÊÂ¼þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 272          
 273          //      0x0359FFFF,  ADR_BLOCK162_EVENII_lowbattery_E2P+6,               EN_R+P_E2P1, 60,120,//¿ªÊ¼¼ÇÂ¼  6*10´Î
 274                  
 275                  // µçÔ´µôµç  // 
 276                  0x03380000,  ADR_BLOCK161_EVENII_PWN_E2P,                      EN_R+P_E2P1,     2,4,    //×Ü´ÎÊý
 277                  0x03380001,  ADR_BLOCK161_EVENII_PWN_E2P+2,                  EN_R+P_E2P1,       4,8,    //ÀÛ¼ÆÊ±¼ä
 278                  0x03380101,  ADR_BLOCK161_EVENII_PWN_E2P+6,                     EN_R+P_E2P1+CM_EBIL, 12,24,              //×î½üÒ»´Îµµ°¸¼ÇÂ¼  Ê
             -Â¼þ´úÂë ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 279                  0x03380102,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 1*6),       EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼þ
             -´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 280                  0x03380103,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 2*6),       EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼þ
             -´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 281                  0x03380104,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 3*6),       EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼þ
             -´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 282                  0x03380105,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 4*6),        EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 283                  0x03380106,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 5*6),        EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 284                  0x03380107,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 6*6),       EN_R+P_E2P1+CM_EBIL, 12,24, //×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼þ´
             -úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 285                  0x03380108,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 7*6),        EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 286                  0x03380109,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 8*6),        EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 287                  0x0338010A,  (ADR_BLOCK161_EVENII_PWN_E2P+6+ 9*6),        EN_R+P_E2P1+CM_EBIL, 12,24, ///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 288          
 289                  //COVER_//
 290                  0x03450000,  ADR_BLOCK163_EVENII_COVER_E2P,           EN_R+P_E2P1,      2,4,    //×Ü´ÎÊý
 291                  0x03450001,  ADR_BLOCK163_EVENII_COVER_E2P+2,         EN_R+P_E2P1,      4,8,    //×Ü´ÎÊý
 292                  0x03450101,  ADR_BLOCK163_EVENII_COVER_E2P+6,                 EN_R+P_E2P1+CM_EBIL, 12,24,                //×î½üÒ»´Îµµ°¸¼ÇÂ¼  ÊÂ
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 9   

             -¼þ´úÂë ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 293                  0x03450102,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 1*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 294                  0x03450103,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 2*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 295                  0x03450104,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 3*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 296                  0x03450105,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 4*6),  EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 297                  0x03450106,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 5*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 298                  0x03450107,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 6*6),  EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 299                  0x03450108,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 7*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 300                  0x03450109,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 8*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½üÈý´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 301                  0x0345010A,  (ADR_BLOCK163_EVENII_COVER_E2P+6+ 9*6),     EN_R+P_E2P1+CM_EBIL, 12,24,///×î½ü¶þ´Îµµ°¸¼ÇÂ¼  ÊÂ¼
             -þ´úÂë  ¿ªÊ¼Ê±¼ä ½áÊøÊ±¼ä
 302          
 303          // ¹¦ÂÊ·´ÏòÊÂ¼þ  //     
 304                  0x03360000,  ADR_BLOCK164_EVENII_L1reverse_E2P,                       EN_R+P_E2P1,      2,4,    //×Ü´ÎÊý
 305                  0x03360001, ( ADR_BLOCK164_EVENII_L1reverse_E2P+2),                EN_R+P_E2P1,         4,8,    //×ÜÀÛ¼ÆÊ±¼ä//
 306                  0x03360101,  (ADR_BLOCK164_EVENII_L1reverse_E2P+6),                EN_R+P_E2P1+CM_EBIL,         12,24,  //¿ªÊ¼Ê±¼
             -ä+½áÊøÊ±¼ä//
 307                  0x03360102, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+1*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 308                  0x03360103,  (ADR_BLOCK164_EVENII_L1reverse_E2P+6+2*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 309                  0x03360104, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+3*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 310                  0x03360105, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+4*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 311                  0x03360106, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+5*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 312                  0x03360107,  (ADR_BLOCK164_EVENII_L1reverse_E2P+6+6*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 313                  0x03360108, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+7*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 314                  0x03360109, ( ADR_BLOCK164_EVENII_L1reverse_E2P+6+8*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 315                  0x0336010A,  (ADR_BLOCK164_EVENII_L1reverse_E2P+6+9*6),         EN_R+P_E2P1+CM_EBIL,    12,24,  //¿ªÊ¼Ê±¼ä+½
             -áÊøÊ±¼ä//
 316          
 317          
 318          //
 319              0x04000100,&gs_CurDateTime.Week,                            EN_RW+P_RAM,7,14,       //×¢ÒâÈÕÆÚ£¬Í¨Ñ¶¶ÁÐ´Ë³Ðò YYMMDDWWhhmmss
 320              0x04000103,ADR_METER_PARAM1_MD,                            EN_RW+P_E2P1,    2,      4,      //×î´óÐèÁ¿ÖÜÆÚ,»¬²îÊ±¼ä//
 321          
 322              0x04000801,ADR_BLOCK83_WEEK_TAB_E2P ,                       EN_RW+P_E2P1,LEN_WEEK_TABLE_ONE,(2*LEN_WEEK_TABLE_ONE), //ÖÜ±í
             -ÆðÊ¼µØÖ·(4¸öÖÜ±í)     
 323              0x04000802,ADR_BLOCK83_WEEK_TAB_E2P+(1*LEN_WEEK_TABLE_ONE),         EN_RW+P_E2P1,LEN_WEEK_TABLE_ONE,(2*LEN_WE
             -EK_TABLE_ONE),        //ÖÜ±íÆðÊ¼µØÖ·(4¸öÖÜ±í)
 324              0x04000803,ADR_BLOCK83_WEEK_TAB_E2P+(2*LEN_WEEK_TABLE_ONE),         EN_RW+P_E2P1,LEN_WEEK_TABLE_ONE,(2*LEN_WE
             -EK_TABLE_ONE),        //ÖÜ±íÆðÊ¼µØÖ·(4¸öÖÜ±í)
 325              0x04000804,ADR_BLOCK83_WEEK_TAB_E2P+(3*LEN_WEEK_TABLE_ONE),         EN_RW+P_E2P1,LEN_WEEK_TABLE_ONE,(2*LEN_WE
             -EK_TABLE_ONE),        //ÖÜ±íÆðÊ¼µØÖ·(4¸öÖÜ±í) 
 326           
 327                  0x04010000,ADR_BLOCK82_SEASON_TAB_E2P,               EN_RW+P_E2P1,LEN_SEASON_TABLE, (2*LEN_SEASON_TABLE), 
             -   // ¼¾½Ú±í 8*3  ÔÂÈÕ+ÖÜ±íºÅ
 328                  0x04010001,ADR_BLOCK84_DAY_TAB_E2P,                             EN_RW+P_E2P1,LEN_DAY_TABLE_ONE, (2*LEN_DAY_TABLE_ONE),//Ê±¶Î±í1  Ê
             -±¶Î±íÆðÊ¼µØÖ·(8¸öÊ±¶Î±í£¬10¸öÊ±¶ÎÊý)  288      BCD  hhnnNN          
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 10  

 329                  0x04010002,ADR_BLOCK84_DAY_TAB_E2P+(1*LEN_DAY_TABLE_ONE),               EN_RW+P_E2P1,LEN_DAY_TABLE_ONE, (2*LEN_DAY_TAB
             -LE_ONE),//Ê±¶Î±í2  Ê±¶Î±íÆðÊ¼µØÖ·(8¸öÊ±¶Î±í£¬10¸öÊ±¶ÎÊý)  288      BCD  hhnnNN          
 330                  0x04010003,ADR_BLOCK84_DAY_TAB_E2P+(2*LEN_DAY_TABLE_ONE),               EN_RW+P_E2P1,LEN_DAY_TABLE_ONE, (2*LEN_DAY_TAB
             -LE_ONE),//Ê±¶Î±í3  Ê±¶Î±íÆðÊ¼µØÖ·(8¸öÊ±¶Î±í£¬10¸öÊ±¶ÎÊý)  288      BCD  hhnnNN          
 331                  0x04010004,ADR_BLOCK84_DAY_TAB_E2P+(3*LEN_DAY_TABLE_ONE),               EN_RW+P_E2P1,LEN_DAY_TABLE_ONE, (2*LEN_DAY_TAB
             -LE_ONE),//Ê±¶Î±í4  Ê±¶Î±íÆðÊ¼µØÖ·(8¸öÊ±¶Î±í£¬10¸öÊ±¶ÎÊý)  288      BCD  hhnnNN          
 332          
 333                  0x04000401,ADR_METER_PARAM1_METER_ID,                   EN_RW+P_E2P1,16,32,     //Í¨Ñ¶µØÖ· ±íºÅ
 334          
 335                  0x04000409,&sys_parm.meter_cons[0],                             EN_R+P_RAM,3,6,         //³£Êý   //             
 336          
 337                  0x04000B01,ADR_METER_PARAM1_SETL_DDHH,          EN_RW+P_E2P1,2,4,       //½áËãÈÕ
 338                  0x04000C01,ADR_METER_PARAM1_PW0,                    EN_W+P_E2P1,4,8,            //0¼¶ÃÜÂë
 339          
 340              0x04000A01,  ADR_METER_PARAM1_load_lptime_inv_var,          EN_RW+P_E2P1,2,4,//¼ÇÂ¼¼ä¸ô
 341              0x04000AA1,  ADR_METER_PARAM1_load_egcode_var,            EN_RW+P_E2P1,10,20, //¸ººÉ±í±àÂë
 342              0x06010000,  &LPRunPa.Num[0],                                   EN_R+P_RAM,2,4, //ÒÑ¼ÇÂ¼ÌõÊý
 343                  
 344                  //ÏÔÊ¾Àà²ÎÊý//
 345              0x04000302,ADR_DIS_PARAM_AUTO_SEC,          EN_RW+P_E2P1,1,2,    //×Ô¶¯Ñ­ÏÔÊ±¼ä 
 346              0x04000303,ADR_DIS_PARAM_EC_FORM,            EN_RW+P_E2P1,1,2,    // µçÁ¿ÏÔÊ¾Î»Êý//
 347              0x04000310,ADR_DIS_PARAM_BG_SEC,                     EN_RW+P_E2P1,1,2,      //±³¹âµãÁÁÊ±¼ä,BCD sec
 348              0x040003A0,ADR_DIS_PARAM_KEY_SEC,                    EN_RW+P_E2P1,1,2,    //¼üÏÔÊ±¼ä
 349              0x04040100,ADR_DIS_PARAM_AUTO_TAB,           EN_RW+P_E2P1,11,22,    //×Ô¶¯Ñ­ÏÔ±í  //
 350              0x04040200,ADR_DIS_PARAM_KEY_TAB,                  EN_RW+P_E2P1,11,22,      //°´¼üÏÔÊ¾ÁÐ±í //
 351              0x04040300,ADR_DIS_PARAM_PWN_TAB,            EN_RW+P_E2P1,10,20,    //ÏÂµçÏÔÊ¾ÁÐ±í//
 352          
 353              0x04800001,&sys_parm.video[0],                                              EN_R+P_RAM,12,12,  //Èí¼þ°æ±¾ºÅ(ASCII)
 354          
 355          /*      //Ð£±í²ÎÊý
 356              0x80800101,&Adjust_Param.SCP_adj_val.B08[0],         EN_RW+P_RAM+W_FCT,4,8,// E1 ¹¦ÂÊ±È²î¼Ä´æÆ÷  // 
 357              0x80800102,&Adjust_Param.SCQ_adj_val.B08[0],     EN_RW+P_RAM+W_FCT,4,8,// E2 ¹¦ÂÊ±È²î¼Ä´æÆ÷  //
 358              0x80800103,&Adjust_Param.SCU_adj_val.B08[0],        EN_RW+P_RAM+W_FCT,4,8,// µçÑ¹ÓÐÐ§Öµ ±È²î¼Ä´æÆ÷//
 359              0x80800104,&Adjust_Param.SCI1_adj_val.B08[0],       EN_RW+P_RAM+W_FCT,4,8,// IA µçÁ÷ÓÐÐ§Öµ3.2M ±È²î¼Ä´æÆ÷//
 360              0x80800105,&Adjust_Param.SCI2_adj_val.B08[0],       EN_RW+P_RAM+W_FCT,4,8,// IB µçÁ÷ÓÐÐ§Öµ3.2M ±È²î¼Ä´æÆ÷   
             -//
 361              0x80800106,&Adjust_Param.PARAPC_adj_val.B08[0],             EN_RW+P_RAM+W_FCT,4,8,// E1 ¹¦ÂÊ±È²î¼Ä´æÆ÷Ð¡ÐÅºÅ²¹³¥Ö
             -µ//
 362              0x80800107,&Adjust_Param.PARAQC_adj_val.B08[0],             EN_RW+P_RAM+W_FCT,4,8,// E2 ¹¦ÂÊ±È²î¼Ä´æÆ÷Ð¡ÐÅºÅ²¹³¥Ö
             -µ//
 363              0x80800108,&Adjust_Param.PHCCTRL1_adj_val.B08[0],   EN_RW+P_RAM+W_FCT,4,8,// I1 ½Ç²îµ÷½Ú¼Ä´æÆ÷ Êµ¼ÊÎª8Î»
             -  //
 364              0x80800109,&Adjust_Param.PHCCTRL2_adj_val.B08[0],   EN_RW+P_RAM+W_FCT,4,8,// I2 ½Ç²îµ÷½Ú¼Ä´æÆ÷ Êµ¼ÊÎª8Î
             -»  //
 365          
 366          
 367                  //Í¨Ñ¶ÅúÁ¿Ð£±í//  
 368              0x0000FEB0, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,   //Ö÷»ØÂ· 1.0L IB Îó²îºÍÓÐÐ§ÖµÐ£×¼// 
 369              0x0000FEB1, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,   //Ö÷»ØÂ· 0.5L IB Îó²îÐ£×¼// 
 370              0x0000FEB2, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,          //´Î»ØÂ·1.0L IB Îó²îÐ£×¼// 
 371              0x0000FEB3, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,   //´Î»ØÂ·0.5L IB Îó²îÐ£×¼// 
 372              0x0000FEB4, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,  //´Î»ØÂ·0.5L IB Îó²îÐ£×¼// 
 373              0x0000FEB5, 0x0000,                                                 EN_W+P_E2P1+W_FCT,12,24,  //´Î»ØÂ·1.0L 5%IB Îó²îÐ£×¼// 
 374          */
 375          
 376              0x80800803,     0x0000,                                             EN_W+P_E2P1+W_FCT,2,4,// EMU¼ÆÁ¿²ÎÊý³õ
             -Ê¼»¯  // 
 377              
 378                  // ÇåÁã//
 379              0x08020100,0x0000,                                                  EN_W+P_RAM,1,2,         //ÐèÁ¿ÇåÁã/ÊÖ¶¯¸´Î»
 380              0x08020200,0x0000,                                                  EN_W+P_RAM,1,2,         //ÊÂ¼þ¼ÇÂ¼ÇåÁã
 381                  0x08020300,0x0000,                                                  EN_W+P_RAM,1,2,                //=00 ¸ººÉ¼ÇÂ¼ÇåÁã  //
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 11  

 382              0x08020400,0x0000,                                                  EN_W+P_RAM,4,8,         //xxxxxxxx = 00000000Ê±Çå³ýµ±Ç°ºÍÀúÊ·µçÁ¿
 383              0x08020500,ADR_METER_PARAM1_FC_CFG,         EN_RW+P_E2P1,4,8,       //¹¤³§³ö³§×´Ì¬×Ö£¬1×Ö½Ú  // 5A:³§ÄÚ   
 384              0x08020600,0x0000,                                                  EN_W+P_RAM,1,2,         //µçÄÜÂö³å¿ÚÇÐ»»¿ØÖÆÃüÁî¡£=0X5A Î»ÃëÂö³åÊä³ö  //
 385              0x04000107,ADR_METER_PARAM1_BAT_LEVEL,      EN_RW+P_E2P1,   1,      2,      // µç³ØµÍÑ¹·§Öµ  1 ×Ö½Ú£¬BCD  X.X 
 386          
 387              0x0000FEFF,0x0000,                                                  EN_W+P_RAM,2,4,         // ³õÊ¼»¯
 388          };
 389          
 390          //---------------------------------------------------------------------//
 391          //¹¦ÄÜ:   ¼ÆËãÓÉÆðÊ¼µØÖ·¿ªÊ¼µ½F½ØÖ¹µÄ³¤¶È//
 392          //     0000F     return 4
 393          //      *Addr Êý¾ÝÆðÊ¼µØÖ·£¬numÊý¾Ý³¤¶È
 394          //---------------------------------------------------------------------//
 395          INT8U get_meter_id_asclen(INT8U *Addr,INT8U numbyte)
 396          {
 397   1              INT8U i;
 398   1              INT8U asclen=0;
 399   1              for(i=0;i<numbyte;i++)
 400   1              {
 401   2                      if((((*(Addr+i))>>4)&0x0F)==0x0F)
 402   2                      {
 403   3                              return asclen;
 404   3                      }
 405   2                      asclen++;
 406   2                      if(((*(Addr+i))&0x0F)==0x0F)
 407   2                      {
 408   3                              return asclen;
 409   3                      }
 410   2                      asclen++;
 411   2              }
 412   1              return asclen;
 413   1      }
 414          
 415          
 416          /*****************************************************************
 417           name:          INT8U  get_comm_var( INT16U id )
 418           function:      get command information precess  
 419           input:         no            
 420           return:        GetComVar()
 421                          =0    succeed  precess 
 422                          =1    fail precess 
 423          *****************************************************************/
 424          INT8U  get_IEC_comm_var( INT32U id )
 425          {
 426   1          INT16U i;  
 427   1              
 428   1        if((id>=0x06010001)&&(id<=0x060105A0))//¸ººÉÊý¾Ý×î¶à¼ÇÂ¼900Ìõ   //SXL 2019-01-6
 429   1        {
 430   2                      comm_data.addr =0;
 431   2                      comm_data.Info.u16 = EN_R;              //²»ÄÜ»òÉÏ
 432   2                      comm_data.len = 0;
 433   2                      comm_data.len_asc = 0;
 434   2                      return TRUE;
 435   2        }
 436   1        if((id>=0x060A0001)&&(id<=0x060A0120))//¸ººÉÊý¾Ý¿é×î¶à¼ÇÂ¼90Ìõ   //SXL 2019-01-6
 437   1        {
 438   2                      comm_data.addr =0;
 439   2                      comm_data.Info.u16 = EN_R;              //²»ÄÜ»òÉÏ
 440   2                      comm_data.len = 0;
 441   2                      comm_data.len_asc = 0;
 442   2                      return TRUE;
 443   2        }
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 12  

 444   1      
 445   1                      for( i = 0 ; i <dim(IEC_ComDisTab) ; i++ )
 446   1          {
 447   2              if( id == IEC_ComDisTab[i].ComID )
 448   2              {
 449   3                  comm_data.addr = IEC_ComDisTab[i].Addr;
 450   3                  comm_data.Info.u16 = IEC_ComDisTab[i].ComInfo;
 451   3                  comm_data.len = IEC_ComDisTab[i].Len;
 452   3                  comm_data.len_asc = IEC_ComDisTab[i].Len_Asc;
 453   3                  return TRUE;
 454   3              }
 455   2          }
 456   1          return FALSE;
 457   1      }
 458          
 459          /*****************************************************************
 460           name:          uchar  GetComVar( uchar* Addr, uint* Info )
 461           function:      get command information precess  
 462           input:         no            
 463           return:        GetComVar()
 464                          =0    succeed  precess 
 465                          =1    fail precess 
 466          *****************************************************************/
 467          INT8U SecurityCK(void)
 468          {
 469   1              INT8U secType;
 470   1              secType = comm_data.Info.B08[0]&0x07; //È¨ÏÞ¼ì²â//
 471   1              /*
 472   1              if(secType ==(W_FCT>>8))
 473   1              {
 474   1                      if(ADJA_KEY)    // 0 ¶Ì½Ó 1 Î´¶Ì½Ó
 475   1                      {
 476   1                              return (mmover);
 477   1                      }
 478   1              }
 479   1          */
 480   1              return (mmok);
 481   1      }
 482          
 483          //-------------------------------------------------------------------------------//
 484          //  Function:      INT8U IEC_Cmd_Password_Deal(INT8U* sptr,INT8U len) 
 485          //  Description:   iec Í¨Ñ¶ÃÜÂëÖ¸Áî´¦Àí³ÌÐò
 486          //  Parameters:    
 487          //  Returns:        ÎÞ                          
 488          //  Others:         
 489          //-------------------------------------------------------------------------------//
 490          INT8U IEC_Cmd_Password_Deal(INT8U* sptr)
 491          {
 492   1        INT8U tmp_8u_01[4];
 493   1        INT8U tmp_8u_02[8];
 494   1      
 495   1          if((gs_uart_iec_app_var[g_ch_comm].iec_status & (COMM_REQUIST_OK_IEC+COMM_INFO_OK_IEC)) != 0x03)   ret
             -urn(FALSE);
 496   1      
 497   1           mem_read(&tmp_8u_01[0], ADR_METER_PARAM1_PW0, 4, MEM_E2P1);
 498   1           Lib_BCD_AscA(&tmp_8u_02[0], &tmp_8u_01[0], 4);
 499   1               
 500   1      
 501   1          if(Lib_Cmp_TwoArry((sptr+5), &tmp_8u_02[0], 8) == 0x00)  
 502   1          {
 503   2               gs_uart_iec_app_var[g_ch_comm].iec_status |= COMM_MIMA_OK_IEC;  // ¸ø³öÇëÇóÃüÁî³É¹¦±êÊ¶ //
 504   2               Get_ACK_Answer(sptr);
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 13  

 505   2               gs_uart_iec_app_var[g_ch_comm].len = 1;
 506   2               return TRUE;
 507   2          }
 508   1          else
 509   1          {
 510   2              if(Lib_Cmp_TwoArry((sptr+5), &Super_mima_iec[0], 8) == 0x00) 
 511   2              {
 512   3                  gs_uart_iec_app_var[g_ch_comm].iec_status |= COMM_MIMA_OK_IEC;  // ¸ø³öÇëÇóÃüÁî³É¹¦±êÊ¶ //
 513   3                  Get_ACK_Answer(sptr);
 514   3                  gs_uart_iec_app_var[g_ch_comm].len = 1;
 515   3                  return TRUE;
 516   3              }
 517   2          }
 518   1      
 519   1          return FALSE;
 520   1      }
 521          
 522          
 523          //-------------------------------------------------------------------------------//
 524          //  Function:      INT8U IEC_Cmd_Read_Deal(INT8U* sptr,INT8U len)
 525          //  Description:   iec Í¨Ñ¶¶ÁÖ¸Áî´¦Àí³ÌÐò
 526          //  Parameters:    
 527          //  Returns:        ÎÞ                          
 528          //  Others:         
 529          //-------------------------------------------------------------------------------//
 530          INT8U IEC_Cmd_Read_Deal(INT8U* sptr)
 531          {
 532   1       INT8U  mem_type;
 533   1       INT8U  data_buff[70];
 534   1       INT8U  *ptr_adr;
 535   1       INT16U ctmp1;
 536   1              union  Union_DWordDef tmp_32u;
 537   1      ST_U32_U08  long_tmp;
 538   1      
 539   1        ST_U16_U08     LPRecStart,LPRecEnd;
 540   1        if((gs_uart_iec_app_var[g_ch_comm].iec_status &(COMM_REQUIST_OK_IEC+COMM_INFO_OK_IEC+COMM_MIMA_OK_IEC)) 
             -!= 0x07)   return(FALSE);     
 541   1          //get comm DI1 DI0
 542   1          Lib_Asc_BCDA(&comm_data.di1_di0.B08[0], sptr+4,8);
 543   1      
 544   1          //get other comm fram data  
 545   1          if(get_IEC_comm_var( comm_data.di1_di0.u32) == 0 )   return(FALSE);
 546   1          if( ( comm_data.Info.u16& EN_R) == 0 )  return(FALSE);
 547   1          //  »ñÈ¡Êý¾ÝµÄ´æ´¢ÀàÐÍ //
 548   1          mem_type = (comm_data.Info.B08[0]>>3)&0x07;         
 549   1          //Êý¾ÝÓòÇåÁã²¢ÉèÖÃ·¢ËÍ³¤¶È
 550   1          Lib_Set_String((sptr+2), '0', comm_data.len_asc);  
 551   1      
 552   1          ptr_adr = comm_data.addr;
 553   1      //²»ÔÚ±í¸ñÄÚID´¦Àí µ¥Ìõ¸ººÉID 
 554   1              if((comm_data.di1_di0.u32>=0x06010001)&&(comm_data.di1_di0.u32<=0x060105A0))
 555   1              {
 556   2                      ctmp1 = (INT16U)(comm_data.di1_di0.u32 - 0x06010001);
 557   2                      if(ctmp1 < LPRunPa.Num[0])      // ¶ÁÈ¡ID Ð¡ÓÚÓÚÒÑ¼ÇÂ¼Êý
 558   2                      {
 559   3                              comm_data.len = LPRec_Read_1(sptr+2, ctmp1);
 560   3                              comm_data.len_asc = 2*comm_data.len;    
 561   3                      }
 562   2                      else
 563   2                      {
 564   3      //                      comm_data.len = LPRec_Read_1(sptr+2, ctmp1);
 565   3      //                      comm_data.len_asc = 2*comm_data.len;    
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 14  

 566   3      //                      Lib_Set_String((sptr+2), 'F', comm_data.len_asc); 
 567   3                              comm_data.len_asc = 0;  
 568   3                      }
 569   2      
 570   2      
 571   2                      // ³É¹¦ºóÊý¾Ý×éÖ¡ //
 572   2                      //api_deal_even_class_recode(ID_CLASS_I_COMM,START);
 573   2                      gs_uart_iec_app_var[g_ch_comm].len= (comm_data.len_asc+5);
 574   2                      *(sptr+0) = STX;
 575   2                      *(sptr+1) = '(';
 576   2                      CLRWDT(); *(sptr+2+comm_data.len_asc) = ')';
 577   2                      *(sptr+gs_uart_iec_app_var[g_ch_comm].len-2) =ETX;
 578   2              CLRWDT();       *(sptr+gs_uart_iec_app_var[g_ch_comm].len-1) = Get_Bcc_Chk(sptr, 1, gs_uart_iec_app_var[g_ch_c
             -omm].len-2);
 579   2      
 580   2                      return(TRUE); 
 581   2              }
 582   1              
 583   1              
 584   1              if((comm_data.di1_di0.u32>=0x060A0001)&&(comm_data.di1_di0.u32<=0x060A0120))//   //SXL 2019-01-6
 585   1        {
 586   2                      LPRecStart.u16 =(INT16U)((comm_data.di1_di0.u32 - 0x060A0001)*BLOCK_MAX_LEN);
 587   2                      LPRecEnd.u16 =LPRecStart.u16+BLOCK_MAX_LEN;
 588   2                      
 589   2                      if(LPReadPara.ReadLoraFlag == FALSE )
 590   2                      {                       
 591   3                              LPReadPara.Original_FrameNum = LPRunPa.Num[0] ;
 592   3                              LPReadPara.Original_Ptr = LPRunPa.Ptr[0] ;
 593   3                      }               
 594   2                      
 595   2                      comm_data.len_asc  = LPRec_Read_Block(sptr+2,LPRecStart.u16, LPRecEnd.u16);
 596   2                       
 597   2                      
 598   2                      if(LPReadPara.ReadLoraFlag == FALSE )   LPReadPara.ReadLoraFlag = TRUE; 
 599   2                              
 600   2                      gs_uart_iec_app_var[g_ch_comm].len= (comm_data.len_asc+5);
 601   2                      CLRWDT(); 
 602   2                      *(sptr+0) = STX;
 603   2                      *(sptr+1) = '(';CLRWDT(); 
 604   2                      *(sptr+2+comm_data.len_asc) = ')';
 605   2                      CLRWDT(); *(sptr+gs_uart_iec_app_var[g_ch_comm].len-2) =ETX;
 606   2                      *(sptr+gs_uart_iec_app_var[g_ch_comm].len-1) = Get_Bcc_Chk(sptr, 1, gs_uart_iec_app_var[g_ch_comm].len-2
             -);
 607   2      CLRWDT(); 
 608   2                      return(TRUE); 
 609   2                      
 610   2                      }
 611   1      
 612   1          // ¸ù¾Ý¶ÁÈ¡Êý¾ÝµÄIDÏîÄ¿×ö·ÖÖ§´¦Àí //
 613   1          switch(comm_data.di1_di0.u32)
 614   1          {   
 615   2              case 0x02010000:    //µçÑ¹ Ô´Êý¾ÝÎªHEX32£¬0.1VÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XXX.XV //
 616   2              case 0x02010100:    //µçÑ¹ Ô´Êý¾ÝÎªHEX32£¬0.1VÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XXX.XV //
 617   2                  Lib_long_bcd4(&long_tmp.B08[0],gs_measure_var_data.gs_really[0].dw_u_val.u32);
 618   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[2], 2);
 619   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 620   2                  break;
 621   2              case 0x02020000:    //µçÁ÷ Ô´Êý¾ÝÎªHEX32£¬0.0001AÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XXX.XXXA //
 622   2              case 0x02020100:    //µçÁ÷ Ô´Êý¾ÝÎªHEX32£¬0.0001AÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XXX.XXXA //
 623   2                  Lib_long_bcd4(&long_tmp.B08[0],(gs_measure_var_data.gs_really[0].dw_i_val.u32));
 624   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[1], 3);
 625   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 15  

 626   2                  break;
 627   2      
 628   2              case 0x02030000:    //¹¦ÂÊÔ´Êý¾ÝÎªHEX32£¬0.0001KWÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XX.XXXXkW //
 629   2              case 0x02030100:    //¹¦ÂÊÔ´Êý¾ÝÎªHEX32£¬0.0001KWÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XX.XXXXkW //
 630   2                  Lib_long_bcd4(&long_tmp.B08[0],(gs_measure_var_data.gs_really[0].dw_p_val.u32));
 631   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[1], 3);
 632   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 633   2                  break;
 634   2      
 635   2              case 0x02060000:    //¹¦ÂÊÒòÊýÊý¾ÝÎªHEX16£¬0.001£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½0.001 //
 636   2              case 0x02060100:    //¹¦ÂÊÒòÊýÊý¾ÝÎªHEX16£¬0.001£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½0.001 //
 637   2                  Lib_word_bcd2(&long_tmp.B08[0],(gs_measure_var_data.gs_really[0].dw_pf_val.u16));
 638   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[0], 2);
 639   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 640   2                  break;
 641   2      
 642   2              case 0x02800002:    //µçÍøÆµÂÊÊý¾ÝÎªHEX16£¬0.01Hz£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½xx.xx //
 643   2                  Lib_word_bcd2(&long_tmp.B08[0],(gs_measure_var_data.gs_really[0].w_freq_val.u16));
 644   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[0], 2);
 645   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 646   2                  break;
 647   2      
 648   2              case 0x02800003:  //Ã¿·ÖÖÓÓÐ¹¦Æ½¾ùÐèÁ¿Ô´Êý¾ÝÎªHEX32£¬0.0001KWÁ¿¸Ù£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½,XX.XXXXkW /
             -/
 649   2                  Lib_long_bcd4(&long_tmp.B08[0],(gs_md_var.min_var[0].val_min ));
 650   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[1], 3);
 651   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 652   2                  break;
 653   2      
 654   2              case 0x02800006:    //µç±íÎÂ¶ÈÊý¾ÝÎªHEX16£¬0.1ÉèÊ©¶È£¬//
 655   2                  //Lib_word_bcd2(&long_tmp.B08[0],(gs_measure_var_data.w_temp.u16));
 656   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &gs_measure_var_data.w_temp.B08[0], 2);
 657   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 658   2                  break;
 659   2                  
 660   2              case 0x02800007:    //µç³ØµçÑ¹Êý¾ÝÎªHEX16£¬0.1V£¬ÐèÒª×ª»»ÎªBCDÂë¸ñÊ½xx.xx V//
 661   2                  Lib_word_bcd2(&long_tmp.B08[0],(gs_measure_var_data.w_bat_v.u16));
 662   2                  Lib_Copy_Str_TwoArry(&data_buff[0], &long_tmp.B08[0], 2);
 663   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 664   2                  break;
 665   2      
 666   2      
 667   2      
 668   2              case 0x04000100://ÈÕÆÚ¼°ÐÇÆÚ(ÆäÖÐ0´ú±íÐÇÆÚÌì)YYMMDDWWhhmmss
 669   2                  Lib_Copy_Str_TwoArry(&data_buff[0], ptr_adr, comm_data.len);
 670   2                  data_buff[7] = data_buff[0];        //ww
 671   2                  data_buff[0] = data_buff[1];        //YY
 672   2                  data_buff[1] = data_buff[2];        //MM
 673   2                  data_buff[2] = data_buff[3];        //DD
 674   2                  data_buff[3] = data_buff[7];        //WW
 675   2                  data_buff[4] = data_buff[4];        //hh
 676   2                  data_buff[5] = data_buff[5];        //mm
 677   2                  data_buff[6] = data_buff[6];        //ss
 678   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 679   2                  break;
 680   2      
 681   2      
 682   2      
 683   2              case 0x04000401://±íµØÖ· ±íºÅ NNNNNNNNNNNN
 684   2                  mem_read(&data_buff[0], comm_data.addr,  comm_data.len,  mem_type );
*** WARNING C214 IN LINE 684 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 685   2                  comm_data.len_asc = get_meter_id_asclen(&data_buff[0], 16);
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 16  

 686   2                  comm_data.len = comm_data.len_asc/2;
 687   2                  Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len);
 688   2      
 689   2                  break;
 690   2      
 691   2              case 0x04800001: //Èí¼þ°æ±¾ºÅ ÒÑÊÇASCÂë
 692   2                  Lib_Copy_Str_TwoArry(sptr+2, ptr_adr, comm_data.len);
 693   2                  break;              
 694   2                              
 695   2              default:
 696   2      ////////////////µçÄÜÁ¿ÌØÊâ´¦Àí/////////////////////////////
 697   2                  if(comm_data.di1_di0.B08[0]==0x00)
 698   2                  {
 699   3                      comm_data.len = LEN_EC_UNIT;   // ÐÞ¸Ä»ñÈ¡³¤¶È//
 700   3                  }
 701   2      ///////////////////////////////////////////////////////////////////
 702   2      
 703   2                  if((comm_data.Info.u16&CM_ALL) == CM_BILL)
 704   2                  {
 705   3                      mem_read(&data_buff[0],  api_get_bill_record_addr(comm_data.addr), comm_data.len,  mem_typ
             -e );
*** WARNING C214 IN LINE 705 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 706   3                  }
 707   2                                                      else if((comm_data.Info.u16&CM_ALL) == CM_EBIL)//ÊÂ¼þ¼ÇÂ¼ÀàÊý¾Ý
 708   2                            {
 709   3                     mem_read(&data_buff[0], comm_data.addr,     (comm_data.len>>1),  mem_type );
*** WARNING C214 IN LINE 709 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 710   3                     mem_read(&data_buff[6], comm_data.addr+60,  (comm_data.len>>1),  mem_type );
*** WARNING C214 IN LINE 710 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 711   3                        }
 712   2                  else 
 713   2                  {
 714   3                      if(mem_type==MEM_RAM)
 715   3                      {
 716   4                          Lib_Copy_Str_TwoArry(&data_buff[0], ptr_adr, comm_data.len);
 717   4                      }
 718   3                      else
 719   3                      {
 720   4                          mem_read(&data_buff[0], comm_data.addr,  comm_data.len,  mem_type );
*** WARNING C214 IN LINE 720 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 721   4                      }
 722   3                  }
 723   2      
 724   2      ////////////////µçÄÜÁ¿ÌØÊâ´¦Àí/////////////////////////////
 725   2                  if(comm_data.di1_di0.B08[0]==0x00)
 726   2                  {
 727   3                      Lib_Copy_Str_TwoArry(&data_buff[10], &data_buff[0], LEN_EC_UNIT);
 728   3                      api_get_energy_LCD(&data_buff[10], gs_dis_param.ec_form, &data_buff[0]) ;   
 729   3                  }
 730   2      ///////////////////////////////////////////////////////////////////
 731   2      
 732   2      ////////////////×î´óÐèÁ¿ÌØÊâ´¦Àí/////////////////////////////
 733   2                  if(comm_data.di1_di0.B08[0]==0x01)
 734   2                  {  
 735   3                      Lib_Copy_Str_TwoArry(&long_tmp.B08[0], &data_buff[0], 4);
 736   3                      Lib_long_bcd4(&data_buff[0],long_tmp.u32);
 737   3                  }
 738   2      ///////////////////////////////////////////////////////////////////            
 739   2                  if(comm_data.len_asc == 5)
 740   2                  {
 741   3                      *(sptr+2) = Lib_BtoA(data_buff[0]&0x0f);
 742   3                      Lib_BCD_AscA(sptr+3, &data_buff[1], 2);   
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 17  

 743   3                  }
 744   2                  else
 745   2                  {
 746   3                      Lib_BCD_AscA(sptr+2, &data_buff[0], comm_data.len); 
 747   3                  }
 748   2                  break;      
 749   2          }
 750   1      
 751   1          // ³É¹¦ºóÊý¾Ý×éÖ¡ //
 752   1          gs_uart_iec_app_var[g_ch_comm].len= (comm_data.len_asc+5);
 753   1          *(sptr+0) = STX;
 754   1          *(sptr+1) = '(';
 755   1          *(sptr+2+comm_data.len_asc) = ')';
 756   1          *(sptr+gs_uart_iec_app_var[g_ch_comm].len-2) =ETX;
 757   1          *(sptr+gs_uart_iec_app_var[g_ch_comm].len-1) = Get_Bcc_Chk(sptr, 1, gs_uart_iec_app_var[g_ch_comm].len
             --2);
 758   1              
 759   1          return(TRUE); 
 760   1      }
 761          
 762          
 763          //-------------------------------------------------------------------------------//
 764          //  Function:      INT8U IEC_Cmd_Write_Deal(INT8U* sptr,INT8U len)
 765          //  Description:   iec Í¨Ñ¶Ð´Ö¸Áî´¦Àí³ÌÐò
 766          //  Parameters:   lenÎªÉèÖÃÊý¾ÝµÄÊµ¼Ê³¤¶È
 767          //  Returns:        ÎÞ                          
 768          //  Others:         
 769          //-------------------------------------------------------------------------------//
 770          INT8U IEC_Cmd_Write_Deal(INT8U* sptr,INT8U len)
 771          {
 772   1      // INT8U tmp_8u_01[16];
 773   1       INT8U  mem_type;
 774   1       INT8U  data_buff[70];
 775   1       INT8U  sectemp;
 776   1       INT8U i,MeterID_LenTmp; //±íºÅ  ÓÐÐ§³¤¶È asc
 777   1       INT8U  *ptr_adr;
 778   1       
 779   1          if((gs_uart_iec_app_var[g_ch_comm].iec_status &(COMM_REQUIST_OK_IEC+COMM_INFO_OK_IEC+COMM_MIMA_OK_IEC)
             -) != 0x07)   return(FALSE);
 780   1          //get comm DI1 DI0
 781   1          Lib_Asc_BCDA(&comm_data.di1_di0.B08[0], sptr+4,8);
 782   1          //get other comm fram data 
 783   1          if(get_IEC_comm_var( comm_data.di1_di0.u32) == 0 )   return(FALSE);
 784   1      
 785   1          if( ( comm_data.Info.u16& EN_W) == 0 )  return(FALSE);
 786   1          //  »ñÈ¡Êý¾ÝµÄ´æ´¢ÀàÐÍ //
 787   1          mem_type = (comm_data.Info.B08[0]>>3)&0x07;         
 788   1          sectemp = SecurityCK();                                     //È¨ÏÞÅÐ¶Ï
 789   1          if(sectemp == mmover)   return(FALSE);
 790   1      
 791   1          //Êý¾ÝÓòÇåÁã²¢¼ì²é½ÓÊÕµÄÊý¾Ý³¤¶ÈºÏ·¨ÐÔ //
 792   1          Lib_Set_String(&data_buff[0], 0x00, comm_data.len); 
 793   1          if(comm_data.di1_di0.u32== 0x04000401) //³ýÉèÖÃ±íºÅÍâ.¶¼ÐèÒª¶Ô±ÈÊý¾Ý³¤¶È
 794   1          {
 795   2              if((len > comm_data.len_asc+16)||(len < 16))
 796   2              return(FALSE);
 797   2          }
 798   1          else
 799   1          {
 800   2              if(len != (comm_data.len_asc+16))          
 801   2              return(FALSE);
 802   2          }
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 18  

 803   1      
 804   1          ptr_adr = comm_data.addr;
 805   1      
 806   1          // ¸ù¾ÝÉèÖÃÊý¾ÝµÄIDÏîÄ¿×ö·ÖÖ§´¦Àí //
 807   1          switch(comm_data.di1_di0.u32)
 808   1          {
 809   2      
 810   2              case 0x04000100://ÈÕÆÚ¼°ÐÇÆÚ(ÆäÖÐ0´ú±íÐÇÆÚÌì)YYMMDDWWhhmmss  
 811   2                  Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 812   2                  gs_CurDateTime.Year= data_buff[0];
 813   2                  gs_CurDateTime.Month= data_buff[1];
 814   2                  gs_CurDateTime.Day= data_buff[2];
 815   2                  gs_CurDateTime.Week= data_buff[3];
 816   2                  gs_CurDateTime.Hour= data_buff[4];
 817   2                  gs_CurDateTime.Minute= data_buff[5];
 818   2                  gs_CurDateTime.Second= data_buff[6];
 819   2                  EA=0;
 820   2                  Set_RTCTime(&gs_CurDateTime);
 821   2                  EA=1;
 822   2                  mem_db_write(ADR_METER_VAR_RTC, &gs_CurDateTime.Week, 7, MEM_E2P1);
 823   2                  //api_handl_settle_month();
 824   2                  api_deal_even_class_recode(ID_CLASS_I_setRtc,START);
 825   2                  api_update_triffNo_pre_minute();
 826   2                  break;
 827   2                              
 828   2      
 829   2                  //±íºÅÌØÊâ´¦Àí
 830   2                  case 0x04000401://±íµØÖ· ±íºÅ 16¸ö×Ö½Ú ×ÔÊÊÓ¦,ÈçÉèÆæÊý£¬ÔòÇ°²¹0
 831   2                      MeterID_LenTmp = (len-16);      //ÓÐÐ§±íºÅ  ³¤¶È
 832   2                      if(((len-16)%2)!=0)     //ÆæÊýÔòÇ°Ãæ²¹Ò»¸ö0
 833   2                      {
 834   3                      for(i=(len-16);i>0;i--)
 835   3                      {
 836   4                      *(sptr+13+i) = *(sptr+13+i-1) ; //ÏòºóÅ²1Î»
 837   4                      }
 838   3                      *(sptr+13)= '0';                                        //¸ßÎ»²¹0
 839   3                      MeterID_LenTmp = (len-16) +1;
 840   3                      }
 841   2                      comm_data.len_asc = MeterID_LenTmp;
 842   2                       Lib_Set_String(&data_buff[0], 0xFF, 16);
 843   2                       Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)                 
 844   2                      mem_db_write(comm_data.addr, &data_buff[0], comm_data.len, mem_type);           //Ð´ÈëÓ¦¸ÃÊÇ16×Ö½Ú£
             -¬¶ø²»ÊÇÉèÖÃµÄ³¤¶È
*** WARNING C214 IN LINE 844 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 845   2                      break;
 846   2      
 847   2                              
 848   2                      case 0x04000B01://½áËãÈÕDDHH 4
 849   2                      Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 850   2                      if((data_buff[0]<0x01)||(data_buff[0]>0x28)||(data_buff[1]>0x23))               //´íÎóÅÐ¶Ï
 851   2                      {
 852   3                          return(FALSE);
 853   3                      }
 854   2                      mem_db_write(comm_data.addr, &data_buff[0], comm_data.len, mem_type);
*** WARNING C214 IN LINE 854 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 855   2                      break;
 856   2      
 857   2                      case 0x04000103://ÐèÁ¿²ÎÊý PERIOD : SLID   4  //ÐÞ¸ÄºóÐèÁ¿ÖØÐÂ¼ÆËã //
 858   2                      Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 859   2                      if(((data_buff[0]%data_buff[1]) !=0)||(data_buff[0]>30)||(data_buff[0]==0)||(data_buff[1]=
             -=0))                //´íÎóÅÐ¶Ï//
 860   2                      {
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 19  

 861   3                          return(FALSE);
 862   3                      }
 863   2                      mem_db_write(comm_data.addr, &data_buff[0], comm_data.len, mem_type);
*** WARNING C214 IN LINE 863 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
 864   2                      api_init_md_data_ram();
 865   2                      break;
 866   2      
 867   2      /*
 868   2      ///////////Îó²îÐ£±í//////////////////
 869   2                      case 0x0000FEB0: 
 870   2                      case 0x0000FEB1:
 871   2                      case 0x0000FEB2:
 872   2                      case 0x0000FEB3:
 873   2                      case 0x0000FEB4:
 874   2                      case 0x0000FEB5:
 875   2                              Measure_Electric_Err_Gain(sptr, comm_data.di1_di0.u32);         //±ØÐëÏÈÐ£×¼Îó²î£¬ÑÓÊ±1ÃëÒÔÉÏÐ£×¼µç²ÎÁ¿²Å×¼/
             -/        
 876   2                              break;
 877   2      
 878   2                      //---- µ¥¶ÀÐ£±í//
 879   2                      case 0x80800101:
 880   2                      case 0x80800102:
 881   2                      case 0x80800103:
 882   2                      case 0x80800104:
 883   2                      case 0x80800105:
 884   2                      case 0x80800106:
 885   2                      case 0x80800107:
 886   2                      case 0x80800108:                
 887   2                      case 0x80800109:
 888   2                      case 0x8080010A:
 889   2                      case 0x8080010B:
 890   2                              Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);
 891   2                              Lib_Copy_Str_TwoArry(&data_buff[0], ptr_adr,4);   //Êý¾Ý¸üÐÂ //
 892   2                          CLRWDT();
 893   2                          Save_EMU_AdjParam();
 894   2                              break;
 895   2      */
 896   2                              
 897   2                      //Ð£±í³õÊ¼»¯(²ÎÊýÇåÁã)   //
 898   2                      case 0x80800803:                
 899   2                      if((*(sptr+13)=='3')&&(*(sptr+14)=='3')&&(*(sptr+15)=='3'))  
 900   2                      {
 901   3                          if((*(sptr+16)=='3'))                                       // clear all
 902   3                          {
 903   4                              //Ð£±í²ÎÊýÇåÁã//
 904   4                              gs_adj_emu_param.w1gain =0;
 905   4                              gs_adj_emu_param.w2gain =0;
 906   4                              CLRWDT();
 907   4                              Save_EMU_AdjParam();
 908   4                          }
 909   3                      }
 910   2                      else
 911   2                      {
 912   3                          return FALSE;
 913   3                      }
 914   2                      break;
 915   2      
 916   2                      case 0x08020100://Ö»Çåµ±Ç°ÐèÁ¿ÇåÁã//
 917   2                          Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 918   2                          if((data_buff[0]!=0))  return(FALSE);
 919   2                          api_clr_current_MD_data();
 920   2                          CLRWDT();
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 20  

 921   2                          api_deal_even_class_recode(ID_CLASS_I_resetMD,START);
 922   2                              break;
 923   2      
 924   2                      case 0x08020200://NN=FF£¬Çå³ýËùÓÐÍ¨µÀ£»//
 925   2                              if((*(sptr+13)=='F')&&(*(sptr+14)=='F'))        //YYY
 926   2                              {
 927   3                                      api_clr_even_by_comm(); 
 928   3                                      CLRWDT();
 929   3                              }
 930   2                              else
 931   2                              {
 932   3                                      return(FALSE);
 933   3                              }
 934   2                              break;
 935   2                      case 0x08020300:
 936   2                              // Asc_BCDA( &data_buff[0],(sptr+13), 1*2);
 937   2                  // Ò»¸öÍ¨µÀ¸ººÉ¼ÇÂ¼Ö¸Õë¡¢¼ÇÂ¼¸öÊý 
 938   2                  if((*(sptr+13)=='0')&&(*(sptr+14)=='0'))    //YYY
 939   2                              {
 940   3                                      LoadProRst();
 941   3                                      CLRWDT();
 942   3                              }
 943   2                              else
 944   2                              {
 945   3                                      return(FALSE);
 946   3                              }
 947   2                              break;
 948   2                  
 949   2                      case 0x08020400://µçÁ¿ÇåÁã(µç±í×ÜÇå(µçÁ¿+ÐèÁ¿)) //
 950   2                          Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 951   2                          if((data_buff[0]!=0)||(data_buff[1]!=0)||(data_buff[2]!=0)||(data_buff[3]!=0))  return
             -(FALSE);
 952   2                          Proc_clr_meter();
 953   2                              break;
 954   2      
 955   2                      case 0x08020600://Âö³å¿Ú¿ØÖÆÃüÁî =0X5A ÐÞ¸ÄÎªÃëÂö³å£¬ÆäËûÖµÎªµçÄÜÂö³å//
 956   2                          Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 957   2                          if(data_buff[0]==METER_FACTORY_MARK)      //  =0X5A ÐÞ¸ÄÎªÃëÂö³å //
 958   2                          {
 959   3                              Open_SecOut();   
 960   3                          }
 961   2                          else
 962   2                          {
 963   3                             Close_SecOut();
 964   3                             CFLED_INITLIZE();    
 965   3                          }
 966   2                              break;
 967   2                  
 968   2                      case 0x0000FEFF:
 969   2                               if((*(sptr+13)=='5')&&(*(sptr+14)=='5')&&(*(sptr+15)=='5')&&(*(sptr+16)=='5'))    //³ýÐ£±í²ÎÊýÍâ£¬ÆäËû
             -²ÎÊý³õÊ¼»¯ÎªÄ¬ÈÏ²ÎÊý  //
 970   2                              {
 971   3                                      mem_db_clr(0);   //Êý¾ÝÇøÐ£ÑéºÍÈ«²¿ÇåÁã //
 972   3                                 while(1)
 973   3                                 {
 974   4                                      NOP();          // ¸´Î»£¬µÈ´ýÊý¾Ý¼ì²é»Ø¸´Êý¾Ý£¬10Ãë×óÓÒ //
 975   4                                 }    
 976   3                                      CLRWDT();
 977   3                              }
 978   2                               if((*(sptr+13)=='3')&&(*(sptr+14)=='3')&&(*(sptr+15)=='3')&&(*(sptr+16)=='3'))   //°üº¬Ð£±í²ÎÊý£¬ËùÓÐ²
             -ÎÊý³õÊ¼»¯ÎªÄ¬ÈÏ²ÎÊý  //
 979   2                              {
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 21  

 980   3                                      mem_db_clr(0XA5);   //Êý¾ÝÇøÐ£ÑéºÍÈ«²¿ÇåÁã //
 981   3                                 while(1)
 982   3                                 {
 983   4                                      NOP();          // ¸´Î»£¬µÈ´ýÊý¾Ý¼ì²é»Ø¸´Êý¾Ý£¬10Ãë×óÓÒ //
 984   4                                 }    
 985   3                                      CLRWDT();
 986   3                              }
 987   2                               
 988   2                              else
 989   2                              {
 990   3                                      return(FALSE);
 991   3                              }
 992   2                              break;
 993   2      
 994   2                default:
 995   2                       Lib_Asc_BCDA(&data_buff[0], (sptr+13), comm_data.len_asc);   //AtoB(INT8U Asc)
 996   2                          
 997   2                       if(mem_type == MEM_RAM)
 998   2                       {
 999   3                             mem_write(comm_data.addr,&data_buff[0], comm_data.len, mem_type);
*** WARNING C214 IN LINE 999 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
1000   3                       }
1001   2                       else
1002   2                       {
1003   3                             mem_db_write(comm_data.addr, &data_buff[0], comm_data.len, mem_type);
*** WARNING C214 IN LINE 1003 OF ..\C_SOURCE\S4_APIUSER\API_USER_COMM.C: 'Argument': conversion: pointer to non-pointer
1004   3                       }
1005   2                                       
1006   2                              break;  
1007   2                         
1008   2              }
1009   1                      
1010   1      // Í¨Ñ¶¹ýºó ÏµÍ³¸üÐÂ
1011   1              if(((comm_data.di1_di0.u32 >= 0x04000801)&&(comm_data.di1_di0.u32 <= 0x04000807))
1012   1                      ||((comm_data.di1_di0.u32 >= 0x04010000)&&(comm_data.di1_di0.u32 <= 0x04010008)))
1013   1              {
1014   2              
1015   2                      api_update_triffNo_pre_minute();
1016   2              }
1017   1      
1018   1      /////////////////ÉèÖÃÏÔÊ¾²ÎÊýºóÐèÒª¸üÐÂ///////
1019   1              if((comm_data.di1_di0.u32 == 0x04000302)||(comm_data.di1_di0.u32 == 0x04000303)||(comm_data.di1_di0.u32 =
             -= 0x04000310)||(comm_data.di1_di0.u32 == 0x040003A0)||(comm_data.di1_di0.u32 == 0x04040100))
1020   1              {
1021   2                      mem_read(&gs_dis_param.auto_sec, ADR_BLOCK21_DIS_PARAM_E2P, LEN_BLOCK21_DIS_PARAM_E2P, MEM_E2P1);
1022   2                      if((gs_dis_param.auto_sec<3)||(gs_dis_param.auto_sec>60))    gs_dis_param.auto_sec = 5;
1023   2                      if((gs_dis_param.key_sec<5)||(gs_dis_param.key_sec>60))    gs_dis_param.key_sec = 30;
1024   2              }       
1025   1              
1026   1              if((comm_data.di1_di0.u32 == 0x04040200)||(comm_data.di1_di0.u32 == 0x04040300))
1027   1              {
1028   2                      mem_read(&gs_dis_param.auto_sec, ADR_BLOCK21_DIS_PARAM_E2P, LEN_BLOCK21_DIS_PARAM_E2P, MEM_E2P1);
1029   2                      if((gs_dis_param.auto_sec<3)||(gs_dis_param.auto_sec>60))   gs_dis_param.auto_sec = 5;
1030   2                      if((gs_dis_param.key_sec<5)||(gs_dis_param.key_sec>60))   gs_dis_param.key_sec = 30;
1031   2              }
1032   1              
1033   1          // Êý¾ÝÉèÖÃ³É¹¦ºóµÄ×éÖ¡²Ù×÷ //
1034   1          api_deal_even_class_recode(ID_CLASS_I_PROG,START);   //Éú³É±à³ÌÊÂ¼þ¼ÇÂ¼ //
1035   1          gs_uart_iec_app_var[g_ch_comm].len= 1;
1036   1          Get_ACK_Answer(sptr);        
1037   1          return(TRUE); 
1038   1      }
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 22  

1039          
1040          
1041          //-------------------------------------------------------------------------------//
1042          //  Function:     INT8U IEC_Cmd_Break_Deal(INT8U* sptr,INT8U len)
1043          //  Description:   iec Í¨Ñ¶ÖÕÖ¹Ö¸Áî´¦Àí³ÌÐò
1044          //  Parameters:   
1045          //  Returns:        ÎÞ                          
1046          //  Others:         
1047          //-------------------------------------------------------------------------------//
1048          INT8U IEC_Cmd_Break_Deal(INT8U* sptr)
1049          {
1050   1      
1051   1             gs_uart_iec_app_var[g_ch_comm].iec_status |= COMM_BREAK_OK_IEC;
1052   1               gs_uart_iec_app_var[g_ch_comm].len= 1;
1053   1             Get_ACK_Answer(sptr);     
1054   1             return(TRUE);  
1055   1      }
1056          
1057          /*****************************************************************************
1058          ** Function name    :api_init_md_data_ram
1059          **
1060          ** Description         :³õÊ¼»¯µ±Ç°ÐèÁ¿¼ÆËãRAMÇøÊý¾Ý£¬³ÌÐò¸´Î»³õÊ¼»¯µ÷ÓÃ        
1061          **
1062          ** Parameters         :NONE          
1063          **
1064          ** Returned value   :NONE
1065          **
1066          **----------------------------------------------------------------------------
1067          ** V01.01  MJ  2016-04-23
1068          ******************************************************************************/
1069          void lnk_tx_comm_ready( uint8 ch,uint8 start_index)
1070          {
1071   1          uint16 u16_badu;
1072   1          //comm_IEC_Tx_Ready();   
1073   1          switch(gs_uart_iec_app_var[ch].baud_rate)
1074   1          {
1075   2              case CBaud_3:
1076   2                  u16_badu =300;
1077   2              break;
1078   2              case CBaud_6:
1079   2                  u16_badu =600;
1080   2              break;
1081   2              case CBaud_12:
1082   2                  u16_badu =1200;
1083   2              break;
1084   2              case CBaud_24:
1085   2                  u16_badu =2400;
1086   2              break;
1087   2              case CBaud_48:
1088   2                  u16_badu =4800;
1089   2              break;
1090   2              case CBaud_96:
1091   2                  u16_badu =9600;
1092   2              break;
1093   2      
1094   2              default:
1095   2                  u16_badu =300;
1096   2              break;
1097   2          }
1098   1      
1099   1          P_IEC_BUFF = &gs_uart_drv_var[ch].buff[0] ;
1100   1              
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 23  

1101   1          Tx_UART_frist(&P_IEC_BUFF[start_index], gs_uart_iec_app_var[ch].len,u16_badu,ch);        // Êý¾Ý·¢ËÍ /
             -/     
1102   1      }
1103          
1104          
1105          /*****************************************************************************
1106          ** Function name    :api_init_md_data_ram
1107          **
1108          ** Description         :³õÊ¼»¯µ±Ç°ÐèÁ¿¼ÆËãRAMÇøÊý¾Ý£¬³ÌÐò¸´Î»³õÊ¼»¯µ÷ÓÃ        
1109          **
1110          ** Parameters         :NONE          
1111          **
1112          ** Returned value   :NONE
1113          **
1114          **----------------------------------------------------------------------------
1115          ** V01.01  MJ  2016-04-23
1116          ******************************************************************************/
1117          void api_handl_COMM_FRAME_ERROR( uint8 ch)
1118          {
1119   1          if(ch==UART_CH0_IR)           
1120   1          {
1121   2              Lib_Clr_String(&gs_uart_iec_app_var[ch].len, sizeof(UART_COMM_APP_VAR));   
1122   2              Init_UART2_hard(300);  //reset_uart(UART_RESET_ALL); 
1123   2              Init_UART_soft(ch); 
1124   2          }
1125   1          
1126   1          if(ch==UART_CH1_RS)
1127   1          {
1128   2              Lib_Clr_String(&gs_uart_iec_app_var[ch].len, sizeof(UART_COMM_APP_VAR));   
1129   2              Init_UART4_hard(300);  //reset_uart(UART_RESET_ALL);  
1130   2              Init_UART_soft(ch); 
1131   2          }
1132   1          
1133   1          return;
1134   1      }
1135          
1136          //-------------------------------------------------------------------------------//
1137          //  Function:      void init_comm_link(INT8U mode)         
1138          //  Description:   ³õÊ¼»¯´®¿ÚÁ´Â·²ã±äÁ¿Êý¾Ý
1139          //  Parameters:   mode: Í¨Ñ¶Í¨µÀÐòºÅ  
1140          //  Returns:        ÎÞ                          
1141          //  Others:         
1142          //-------------------------------------------------------------------------------//
1143          void process_iec62056_21 (INT8U ch)
1144          {
1145   1       INT8U buff_size;
1146   1       INT8U start_index;
1147   1       INT8U meterID_len;
1148   1      
1149   1       INT8U tmp_8u_01[16];
1150   1       INT8U tmp_8u_02[32];
1151   1      
1152   1       INT16U  u16_badu;
1153   1      
1154   1          
1155   1          if(ch > UART_CH_INDEX_MAX )  return ;
1156   1          
1157   1          if(gs_uart_iec_app_var[ch].tx_delay_flg ==TRUE ) 
1158   1          {
1159   2              return ;    //·¢ËÍµÈ´ý×´Ì¬Ê±ÍË³ö //
1160   2          }
1161   1      
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 24  

1162   1          buff_size = Get_UART_rx_buff(&P_IEC_BUFF,ch);
1163   1          if(buff_size==0)   return;    // Ã¿¸öÑ­»·»ñÈ¡Ò»´Î½ÓÊÕÊý¾Ý³¤¶È£¬=0£¬ÍË³ö //
1164   1      
1165   1      /////////////////////////////////////////////////////////////////////////
1166   1          if((gs_uart_iec_app_var[ch].iec_status & (COMM_INFO_OK_IEC)) !=0)
1167   1          {
1168   2              CLRWDT();
1169   2              CLRWDT();
1170   2          }
1171   1      
1172   1          if((gs_uart_iec_app_var[ch].iec_status & (COMM_REQUIST_OK_IEC)) !=0)
1173   1          {
1174   2              CLRWDT();
1175   2              CLRWDT();
1176   2          }
1177   1      
1178   1          if((gs_uart_iec_app_var[ch].iec_status & (COMM_MIMA_OK_IEC)) !=0)
1179   1          {
1180   2              CLRWDT();
1181   2              CLRWDT();
1182   2          }
1183   1      
1184   1      ////////////////////////////////////////////////////////////////////////
1185   1      
1186   1          // Ç°µ¼×Ö½Ú´¦Àí //
1187   1          for(start_index=0;start_index<10;start_index++)
1188   1          {
1189   2              if((P_IEC_BUFF[start_index]=='/')||(P_IEC_BUFF[start_index]==ACKCOM)||(P_IEC_BUFF[start_index]==SO
             -H))  break;
1190   2          }
1191   1      
1192   1          if(start_index>5)
1193   1          {
1194   2              //½ÓÊÕµÄÊý¾ÝÖ¡´íÎó£¬²¹³ä´®¿Ú¸´Î»²Ù×÷      //
1195   2              api_handl_COMM_FRAME_ERROR(ch);
1196   2              return;
1197   2          }
1198   1      
1199   1          gs_uart_iec_app_var[ch].tx_delay_flg =FALSE;   // ÓÐÊý¾Ý½ÓÊÕÊ±Çå³ý·¢ËÍÑÓÊ±±êÊ¶ //
1200   1          gs_uart_iec_app_var[ch].delay_10ms = 0;   // ÓÐÊý¾Ý´¦ÀíÊ±Çå³ýÑÓÊ±¼ÆÊýÆ÷ //
1201   1          gs_uart_iec_app_var[ch].err_flg = 0;
1202   1          g_ch_comm = ch;
1203   1          
1204   1          if(((buff_size >2) &&((P_IEC_BUFF[buff_size-2]) == CR ||(P_IEC_BUFF[buff_size-2]) == ETX )) )
1205   1          {
1206   2              buff_size =buff_size-start_index;
1207   2              // Êý¾ÝÖ¡´¦Àí //
1208   2              switch(P_IEC_BUFF[start_index])
1209   2              {
1210   3                  case IEC_COMM_REQUEST:      
1211   3                      if((gs_uart_iec_app_var[ch].iec_status & COMM_INFO_OK_IEC) !=0)
1212   3                      {
1213   4                          api_handl_COMM_FRAME_ERROR(ch);
1214   4                          return;
1215   4                      }
1216   3      
1217   3      //                if((buff_size==IEC_START_LENTH05) &&(ch==UART_CH0_IR))
1218   3      //                {
1219   3      //                    api_handl_COMM_FRAME_ERROR(ch);
1220   3      //                    return;
1221   3      //                }
1222   3                      mem_read (&tmp_8u_01[0],ADR_METER_PARAM1_METER_ID, 16,MEM_E2P1);
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 25  

1223   3                      meterID_len = get_meter_id_asclen(&tmp_8u_01[0], 16);   //»ñÈ¡±íºÅÓÐÐ§asc³¤¶È
1224   3                      Lib_BCD_AscA(&tmp_8u_02[0], &tmp_8u_01[0], 16);
1225   3                          
1226   3                      if(IEC_Comm_Request_Cmd_Judge(&P_IEC_BUFF[start_index], buff_size, &tmp_8u_02[0],meterID_l
             -en)==TRUE)
1227   3                      {
1228   4                          if(ch==UART_CH0_IR)   // ºìÍâ1200BPS//
1229   4                         {
1230   5                               Get_IEC_Comm_Request_Cmd_Answer(&P_IEC_BUFF[start_index], Meter_INFO_LENTH,(uint8
             -*)&meter_info_IR[0]);
1231   5                          }
1232   4                           if(ch==UART_CH1_RS)  // RS485 2400BPS//
1233   4                         {
1234   5                               Get_IEC_Comm_Request_Cmd_Answer(&P_IEC_BUFF[start_index], Meter_INFO_LENTH,(uint8
             -*)&meter_info[0]);
1235   5                          }           
1236   4                          gs_uart_iec_app_var[ch].len = Meter_INFO_LENTH+3;
1237   4                          gs_uart_iec_app_var[ch].iec_status |= COMM_INFO_OK_IEC;    // ÎÕÊÖÃüÁî³É¹¦±êÊ¶ //
1238   4                      }
1239   3                      else
1240   3                      {
1241   4                          //¿¼ÂÇµ½¿ª·ÅÊ½Í¨Ñ¶£¬Ê§°ÜÊ±²»·µ»ØÊý¾Ý //
1242   4                          api_handl_COMM_FRAME_ERROR(ch);
1243   4                          return;
1244   4                      }
1245   3                  break;
1246   3      
1247   3                  case IEC_COMM_ACKNOWLEDGEMENT:
1248   3                      if((gs_uart_iec_app_var[ch].iec_status & COMM_INFO_OK_IEC) ==0)
1249   3                      {
1250   4                          api_handl_COMM_FRAME_ERROR(ch);
1251   4                          return;
1252   4                      }
1253   3                      if(IEC_Comm_Acknowledgement_Cmd_Judge(&P_IEC_BUFF[start_index],buff_size)==TRUE)
1254   3                      {
1255   4                          gs_uart_iec_app_var[ch].baud_rate = P_IEC_BUFF[start_index+2];                        
             -                   //²¨ÌØÂÊ¸³Öµ  //
1256   4                          Get_IEC_Comm_Operand_Answer(&P_IEC_BUFF[start_index], MIMA_INFO_LENTH,(uint8*)&mima_in
             -fo[0]);    // »ñÈ¡Êý¾Ý×éÖ¡ //
1257   4                          gs_uart_iec_app_var[ch].len = (MIMA_INFO_LENTH+6);
1258   4                          gs_uart_iec_app_var[ch].iec_status |= COMM_REQUIST_OK_IEC;  // ¸ø³öÇëÇóÃüÁî³É¹¦±êÊ¶ //
1259   4                      }
1260   3                      else
1261   3                      {
1262   4                          gs_uart_iec_app_var[ch].iec_status &= ~COMM_REQUIST_OK_IEC;  // clr ÇëÇóÃüÁî³É¹¦±êÊ¶ /
             -/
1263   4                          Get_Error_Answer(&P_IEC_BUFF[start_index]);
1264   4                          gs_uart_iec_app_var[ch].len = 1;
1265   4                      }
1266   3      
1267   3                  break;
1268   3      
1269   3                  case IEC_COMM_COMMAND:
1270   3                      if((gs_uart_iec_app_var[ch].iec_status & COMM_REQUIST_OK_IEC) ==0)
1271   3                      {
1272   4                          api_handl_COMM_FRAME_ERROR(ch);
1273   4                          return;
1274   4                      }              
1275   3                      if(IEC_Comm_Command_Cmd_Judge(&P_IEC_BUFF[start_index],buff_size) !=TRUE)
1276   3                      {
1277   4                          // Êý¾Ý½âÎöÊ§°Ü //
1278   4                          Get_Error_Answer(&P_IEC_BUFF[start_index]);
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 26  

1279   4                          gs_uart_iec_app_var[ch].len = 1;                       
1280   4                      }
1281   3                  break;
1282   3      
1283   3                  default:
1284   3                      gs_uart_iec_app_var[ch].err_flg |= FRAME_ERROR;   //Ö¡´íÎó£¬ÐèÒª¸´Î»  //        
1285   3                  break;
1286   3              }
1287   2      
1288   2          }
1289   1          else
1290   1          {
1291   2              gs_uart_iec_app_var[ch].err_flg |= FRAME_ERROR;   //Ö¡´íÎó£¬ÐèÒª¸´Î»  //        
1292   2          }
1293   1      
1294   1          if((gs_uart_iec_app_var[ch].err_flg & FRAME_ERROR) )
1295   1          {
1296   2              //½ÓÊÕµÄÊý¾ÝÖ¡´íÎó£¬²¹³ä´®¿Ú¸´Î»²Ù×÷      //
1297   2              api_handl_COMM_FRAME_ERROR(ch);
1298   2              return;
1299   2          }
1300   1          else
1301   1          {
1302   2              
1303   2              gs_uart_iec_app_var[ch].tx_delay_flg =TRUE;
1304   2              gs_uart_iec_app_var[ch].tx_ready_10ms = COMM_DELAY_100MS;   // ÓÐÊý¾Ý´¦ÀíÊ±Çå³ýÑÓÊ±¼ÆÊýÆ÷ //
1305   2              gs_uart_iec_app_var[ch].delay_10ms = 0;   
1306   2              if(gs_uart_iec_app_var[ch].iec_status ==(COMM_INFO_OK_IEC+COMM_REQUIST_OK_IEC))
1307   2              {
1308   3                  gs_uart_iec_app_var[ch].tx_ready_10ms  += 30;   // ÇÐ»»²¨ÌØÂÊÊ±ÑÓÊ±Ôö¼Ó300ms //
1309   3              }
1310   2              gs_uart_iec_app_var[ch].start_index = start_index;
1311   2      
1312   2          }
1313   1      }
1314          
1315          
1316          /*****************************************************************************
1317          ** Function name    :api_init_md_data_ram
1318          **
1319          ** Description         :³õÊ¼»¯µ±Ç°ÐèÁ¿¼ÆËãRAMÇøÊý¾Ý£¬³ÌÐò¸´Î»³õÊ¼»¯µ÷ÓÃ        
1320          **
1321          ** Parameters         :NONE          
1322          **
1323          ** Returned value   :NONE
1324          **
1325          **----------------------------------------------------------------------------
1326          ** V01.01  MJ  2016-04-23
1327          ******************************************************************************/
1328          void api_handl_COMM_pre_10ms(uint8 ch)
1329          {
1330   1      
1331   1          process_iec62056_21(ch);    
1332   1          
1333   1          if(gs_uart_iec_app_var[ch].delay_10ms >COMM_DELAY_3500MS)
1334   1          {   
1335   2              //³¬Ê±ÍË³öÎÕÊÖ£¬ÖØÐÂ½øÈë¿ÕÏÐµÈ´ý×´Ì¬ //
1336   2              api_handl_COMM_FRAME_ERROR(ch);    
1337   2          }
1338   1      
1339   1          if((gs_uart_iec_app_var[ch].tx_ready_10ms ==0)&&(gs_uart_iec_app_var[ch].tx_delay_flg ==TRUE))
1340   1          {   
C51 COMPILER V9.01   API_USER_COMM                                                         01/31/2019 13:21:19 PAGE 27  

1341   2              //Êý¾Ý×¼±¸·¢ËÍ   //
1342   2              gs_uart_iec_app_var[ch].tx_delay_flg =FALSE;
1343   2              lnk_tx_comm_ready(ch,gs_uart_iec_app_var[ch].start_index);     
1344   2          }
1345   1      
1346   1      
1347   1      
1348   1      }
1349          
1350          
1351          /***************************************************************
1352          *    END
1353          ****************************************************************/
1354          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6630    ----
   CONSTANT SIZE    =   3064    ----
   XDATA SIZE       =     36     254
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  10 WARNING(S),  0 ERROR(S)
